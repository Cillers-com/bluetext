# Polytope Documentation Reference

This file contains comprehensive documentation about Polytope, a job runner platform that uses computational graphs based on steps and modules.

## Core Concepts

### Jobs and Steps
- A **job** is a computational graph based on one or more **steps** arranged in any configuration
- Each step runs a **module** which executes code against Polytope's runner API
- Steps can spawn containers, save datasets, create services, and perform other actions

### Modules
- Modules are the core building blocks of Polytope
- Each step runs a module that interfaces with Polytope's runner API
- Polytope provides 50+ built-in modules for common use cases
- Custom modules can be defined using the same interface
- Modules typically accept parameter input conforming to specified types
- Modules can run code snippets directly or wrap other modules

### Templates
- Templates are blueprints for full jobs
- Define what steps to run for easy reuse
- Specified using TemplateSpec data type

### Configuration Files
- Modules, templates, and triggers are defined in Polytope files
- Supported formats: `polytope.yml`, `polytope.json`, or `polytope.edn`
- Files are placed in Git-versioned repositories

### Other Key Concepts
- **Containers**: Docker containers spawned by steps, with replication and autoscaling support
- **Datasets**: Versioned data that can be used as step inputs/outputs
- **Services**: Expose container ports for interaction (localhost for CLI, autogenerated URLs for web service)
- **Values**: Built-in key-value store for steps to read/write
- **Volumes**: Share data between different steps or jobs
- **Triggers**: Run jobs on schedule or following specific events
- **Projects**: Work organization unit in web service, can be owned by users or organizations

## Built-in Modules Reference

### AI/ML and Development Tools
- **polytope/assistant** - LLM-powered coding assistant
- **polytope/jupyter** - Jupyter notebook server
- **polytope/tensorboard** - Tensorboard instance for ML visualization
- **polytope/repl** - Read-eval-print loop for interactive runner API access

### Container and Image Management
- **polytope/build-image** - Build container images
- **polytope/container** - Run Docker containers

### Databases
- **polytope/postgres** - PostgreSQL database server
  - **polytope/postgres!psql** - PSQL shell
  - **polytope/postgres!simple** - PostgreSQL with minimal configuration
- **polytope/couchbase** - Couchbase NoSQL database
  - **polytope/couchbase!cbq** - CBQ query tool
  - **polytope/couchbase!cli** - Couchbase CLI
  - **polytope/couchbase!create-bucket** - Bucket creation
  - **polytope/couchbase!init-cluster** - Cluster initialization

### Message Queues and Streaming
- **polytope/kafka** - Apache Kafka message broker
  - **polytope/kafka!connect** - Kafka Connect
  - **polytope/kafka!control-center** - Confluent Control Center
  - **polytope/kafka!create-connectors** - Create Kafka Connect connectors
  - **polytope/kafka!kcat** - kcat utility
  - **polytope/kafka!schema-registry** - Kafka Schema Registry
- **polytope/redpanda** - Redpanda streaming platform
  - **polytope/redpanda!console** - Redpanda console

### Web Servers and API Gateways
- **polytope/nginx** - Nginx web server
- **polytope/kong** - Kong API Gateway
  - **polytope/kong!simple** - Kong with pre-specified plugins and config

### Programming Language Runtimes
- **polytope/python** - Python container
  - **polytope/python!simple** - Python with minimal configuration
- **polytope/node** - Node.js container

### Development and DevOps Tools
- **polytope/pulumi-cli** - Pulumi infrastructure as code CLI
- **polytope/ngrok** - Ngrok tunneling service
  - **polytope/ngrok!http** - Ngrok HTTP agent

### Communication and Utilities
- **polytope/send-slack-message** - Send messages via Slack webhook
- **polytope/mailpit** - Email testing tool
- **polytope/hello-world** - Simple "Hello world!" message printer

### Identity and Security
- **polytope/curity** - Curity identity server

### Project Management
- **polytope/create-project** - Create example projects from templates

## Data Types Reference

### Key Configuration Types
- **PolytopeFile**: Main configuration file structure
- **ModuleSpec**: Specification for defining a module
- **TemplateSpec**: Specification for defining a template
- **JobSpec**: Job specification
- **ContainerSpec**: Container specification
- **ServiceSpec**: Service specification
- **TriggerSpec**: Trigger specification

### Reference Types
- **ModuleRef**: String reference to a module
- **TemplateRef**: String reference to a template
- **JobRef**: String reference to a job
- **ContainerRef**: String reference to a container
- **ServiceRef**: String reference to a service
- **DatasetRef**: String reference to a dataset

### Other Important Types
- **Code**: String or any representation of code
- **Duration**: String duration of time
- **Timestamp**: String timestamp
- **CronExpr**: String cron schedule expression
- **EnvVarSpec**: Environment variable specification
- **MountSourceSpec**: Container mount source specification

## Usage Examples

### Running Built-in Modules
```bash
# Run Jupyter notebook
pt run polytope/jupyter

# Run Tensorboard
pt run polytope/tensorboard

# Run PostgreSQL with custom parameters
pt run 'polytope/postgres{port: 5433, database: mydb}'
```

### Creating Projects
```bash
# Create a web application project
pt run 'polytope/create-project{template: webapp, name: my-app}'

# Navigate to project and run stack
cd my-app
pt run stack

# Run CI pipeline
pt run ci

# Run CI with review environment
pt run ci-review
```

### Module Parameter Syntax
Modules accept parameters using curly brace syntax:
```bash
pt run 'module-name{param1: value1, param2: value2}'
```

## Configuration File Structure

### Basic polytope.yml Structure
```yaml
# Modules definition
modules:
  my-module:
    # Module specification
    
# Templates definition  
templates:
  my-template:
    # Template specification
    
# Triggers definition
triggers:
  my-trigger:
    # Trigger specification
```

### Module Definition Example
```yaml
modules:
  web-stack:
    steps:
      - name: database
        module: polytope/postgres
        parameters:
          database: myapp
          port: 5432
      - name: web-server
        module: polytope/nginx
        parameters:
          port: 80
```

## Common Use Cases

### Web Application Development
- Use `polytope/postgres` for database
- Use `polytope/nginx` or `polytope/node` for web server
- Use `polytope/create-project` to bootstrap projects
- Define stack, CI, and review environment templates

### Data Science and ML
- Use `polytope/jupyter` for interactive development
- Use `polytope/tensorboard` for model visualization
- Use `polytope/python` for custom Python environments

### Microservices and APIs
- Use `polytope/kong` for API gateway
- Use `polytope/kafka` or `polytope/redpanda` for messaging
- Use `polytope/container` for custom services

### Development Tooling
- Use `polytope/repl` for interactive API exploration
- Use `polytope/assistant` for AI-powered coding help
- Use `polytope/ngrok` for exposing local services

## Best Practices

1. **Module Selection**: Choose the most specific module for your use case (e.g., `polytope/postgres!simple` for basic PostgreSQL)
2. **Parameter Configuration**: Always specify required parameters and consider optional ones for customization
3. **Template Reuse**: Create templates for common workflows to ensure consistency
4. **Environment Management**: Use the same configuration for development, staging, and production
5. **Service Exposure**: Use services to expose container ports for external access
6. **Data Management**: Use datasets and volumes for persistent data storage and sharing

## Module Categories Summary

- **Databases**: postgres, couchbase (with various sub-modules)
- **Message Queues**: kafka, redpanda (with ecosystem tools)
- **Web Servers**: nginx, kong (API gateway)
- **Languages**: python, node
- **AI/ML**: jupyter, tensorboard, assistant
- **DevOps**: pulumi-cli, build-image, container
- **Communication**: send-slack-message, mailpit
- **Development**: repl, create-project, hello-world
- **Security**: curity
- **Networking**: ngrok

This comprehensive reference should provide all the context needed to work effectively with Polytope configurations and module selection.

## polytope.yml file

Is of the data type PolytopeFile so it should be follow this schema. 
